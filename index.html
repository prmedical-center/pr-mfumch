<!doctype html>
<html lang="th" class="h-full">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå - MFU Medical Center</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Kanit', sans-serif; box-sizing: border-box; }
    .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); background-attachment: fixed; }
    .card-shadow { box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15); }
    .fade-in { animation: fadeIn 0.4s ease-out; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    
    /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô */
    .calendar-container { min-height: 600px; }
    .day-cell { min-height: 100px; transition: all 0.2s; border: 1px solid #f0f0f0; }
    .day-cell:hover { background-color: #f8faff; border-color: #667eea; }
    .today { background-color: #eef2ff; border: 2px solid #667eea !important; }
    .event-badge { 
      font-size: 10px; line-height: 1.2; padding: 2px 4px; border-radius: 4px;
      margin-bottom: 2px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
      background-color: #667eea; color: white;
    }
  </style>
</head>
<body class="h-full gradient-bg overflow-x-hidden">
  <div id="app" class="min-h-full py-8 px-4 md:px-8">
    <div class="max-w-5xl mx-auto">
      
      <div class="text-center mb-10 fade-in text-white">
        <h1 class="text-3xl md:text-5xl font-bold mb-3">‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå</h1>
        <p class="text-white/80 text-lg">‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡πÅ‡∏°‡πà‡∏ü‡πâ‡∏≤‡∏´‡∏•‡∏ß‡∏á</p>
        
        <div class="bg-white/10 backdrop-blur-md rounded-2xl p-6 mt-8 text-left border border-white/20 inline-block w-full max-w-3xl">
          <p class="font-semibold mb-2">üìã ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£:</p>
          <div class="grid md:grid-cols-2 gap-2 text-sm text-white/90">
            <div>‚Ä¢ ‡∏ú‡∏•‡∏¥‡∏ï‡∏™‡∏∑‡πà‡∏≠/‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠: 10-20 ‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£</div>
            <div>‚Ä¢ ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡πà‡∏≤‡∏ß: 1-3 ‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£</div>
            <div class="text-yellow-300 md:col-span-2 mt-2 font-medium">‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 15 ‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£</div>
          </div>
        </div>
      </div>

      <div class="flex justify-center mb-8">
        <div class="bg-black/20 backdrop-blur-lg rounded-full p-1.5 flex gap-1 border border-white/10">
          <button onclick="showTab('book')" id="btn-tab-book" class="px-8 py-2.5 rounded-full font-medium transition-all bg-white text-indigo-700 shadow-lg">
            üìù ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÉ‡∏´‡∏°‡πà
          </button>
          <button onclick="showTab('list')" id="btn-tab-list" class="px-8 py-2.5 rounded-full font-medium transition-all text-white hover:bg-white/10">
            üìÖ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå
          </button>
        </div>
      </div>

      <div id="book-section" class="bg-white rounded-[2rem] card-shadow p-8 md:p-10 fade-in">
        <form id="appointment-form" onsubmit="handleSubmit(event)">
          <div class="grid md:grid-cols-2 gap-6">
            <div class="space-y-1">
              <label class="text-sm font-semibold text-gray-600 ml-1">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• (‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏á‡∏≤‡∏ô) *</label>
              <input type="text" name="coordinator_name" required class="w-full px-5 py-3.5 rounded-2xl border border-gray-200 focus:border-indigo-500 focus:ring-4 focus:ring-indigo-100 outline-none transition-all" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
            </div>
            <div class="space-y-1">
              <label class="text-sm font-semibold text-gray-600 ml-1">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô *</label>
              <input type="text" name="department" required class="w-full px-5 py-3.5 rounded-2xl border border-gray-200 focus:border-indigo-500 focus:ring-4 focus:ring-indigo-100 outline-none transition-all" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ù‡πà‡∏≤‡∏¢/‡πÅ‡∏ú‡∏ô‡∏Å">
            </div>
            <div class="space-y-1">
              <label class="text-sm font-semibold text-gray-600 ml-1">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå (‡∏†‡∏≤‡∏¢‡πÉ‡∏ô) *</label>
              <input type="tel" name="phone_internal" required class="w-full px-5 py-3.5 rounded-2xl border border-gray-200 focus:border-indigo-500 focus:ring-4 focus:ring-indigo-100 outline-none transition-all" placeholder="‡πÄ‡∏ä‡πà‡∏ô 1234">
            </div>
            <div class="space-y-1">
              <label class="text-sm font-semibold text-gray-600 ml-1">‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏≤‡∏ô/‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° *</label>
              <input type="text" name="event_title" required class="w-full px-5 py-3.5 rounded-2xl border border-gray-200 focus:border-indigo-500 focus:ring-4 focus:ring-indigo-100 outline-none transition-all" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏±‡∏°‡∏°‡∏ô‡∏≤‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£ 2026">
            </div>
            <div class="md:col-span-2">
              <label class="text-sm font-semibold text-gray-600 ml-1 mb-3 block">‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏ô‡∏∏‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå *</label>
              <div class="grid grid-cols-2 md:grid-cols-4 gap-4 bg-gray-50 p-5 rounded-2xl border border-dashed border-gray-300">
                <label class="flex items-center gap-2 cursor-pointer hover:text-indigo-600"><input type="checkbox" name="services" value="‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û" class="w-4 h-4 rounded"> ‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û</label>
                <label class="flex items-center gap-2 cursor-pointer hover:text-indigo-600"><input type="checkbox" name="services" value="‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠"> ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠/‡∏ï‡∏±‡∏î‡∏ï‡πà‡∏≠</label>
                <label class="flex items-center gap-2 cursor-pointer hover:text-indigo-600"><input type="checkbox" name="services" value="‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏™‡∏∑‡πà‡∏≠"> ‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏™‡∏∑‡πà‡∏≠</label>
                <label class="flex items-center gap-2 cursor-pointer hover:text-indigo-600"><input type="checkbox" name="services" value="‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡πà‡∏≤‡∏ß"> ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡πà‡∏≤‡∏ß</label>
                <label class="flex items-center gap-2 cursor-pointer hover:text-indigo-600"><input type="checkbox" name="services" value="‡∏û‡∏¥‡∏ò‡∏µ‡∏Å‡∏£"> ‡∏û‡∏¥‡∏ò‡∏µ‡∏Å‡∏£</label>
                <label class="flex items-center gap-2 cursor-pointer hover:text-indigo-600"><input type="checkbox" name="services" value="Live"> Live/‡∏™‡∏î</label>
              </div>
            </div>
            <div class="space-y-1">
              <label class="text-sm font-semibold text-gray-600 ml-1">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡∏á‡∏≤‡∏ô *</label>
              <input type="date" id="date-input" name="preferred_date" required class="w-full px-5 py-3.5 rounded-2xl border border-gray-200 focus:border-indigo-500 outline-none">
            </div>
            <div class="space-y-1">
              <label class="text-sm font-semibold text-gray-600 ml-1">‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô *</label>
              <input type="time" name="preferred_time" required class="w-full px-5 py-3.5 rounded-2xl border border-gray-200 focus:border-indigo-500 outline-none">
            </div>
            <div class="md:col-span-2 space-y-1">
              <label class="text-sm font-semibold text-gray-600 ml-1">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà (‡∏£‡∏∞‡∏ö‡∏∏‡πÉ‡∏´‡πâ‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î) *</label>
              <input type="text" name="location" required class="w-full px-5 py-3.5 rounded-2xl border border-gray-200 focus:border-indigo-500 outline-none" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ä‡∏±‡πâ‡∏ô 3 ‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ô‡∏≠‡∏Å">
            </div>
          </div>
          <button type="submit" id="submit-btn" class="w-full mt-10 bg-indigo-600 text-white font-bold py-5 rounded-2xl hover:bg-indigo-700 shadow-xl shadow-indigo-200 transition-all flex items-center justify-center gap-3 text-lg">
            <span id="btn-text">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠</span>
            <div id="btn-spinner" class="w-6 h-6 border-4 border-white/30 border-t-white rounded-full animate-spin hidden"></div>
          </button>
        </form>
      </div>

      <div id="list-section" class="hidden bg-white rounded-[2rem] card-shadow p-6 md:p-8 fade-in calendar-container">
        <div class="flex flex-col md:flex-row justify-between items-center mb-8 gap-4">
          <h2 id="calendar-month" class="text-2xl font-bold text-gray-800 border-l-4 border-indigo-600 pl-4 uppercase"></h2>
          <div class="flex gap-3 bg-gray-100 p-1.5 rounded-xl">
            <button onclick="changeMonth(-1)" class="px-4 py-2 bg-white rounded-lg shadow-sm hover:bg-indigo-50 transition-colors">‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
            <button onclick="changeMonth(1)" class="px-4 py-2 bg-white rounded-lg shadow-sm hover:bg-indigo-50 transition-colors">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
          </div>
        </div>
        
        <div class="overflow-x-auto">
          <div id="calendar-grid" class="grid grid-cols-7 min-w-[700px] border-t border-l border-gray-100 rounded-xl overflow-hidden shadow-sm">
            <div class="bg-indigo-600 text-white py-3 text-center text-sm font-bold uppercase">‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå</div>
            <div class="bg-indigo-600 text-white py-3 text-center text-sm font-bold uppercase">‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå</div>
            <div class="bg-indigo-600 text-white py-3 text-center text-sm font-bold uppercase">‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£</div>
            <div class="bg-indigo-600 text-white py-3 text-center text-sm font-bold uppercase">‡∏û‡∏∏‡∏ò</div>
            <div class="bg-indigo-600 text-white py-3 text-center text-sm font-bold uppercase">‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ</div>
            <div class="bg-indigo-600 text-white py-3 text-center text-sm font-bold uppercase">‡∏®‡∏∏‡∏Å‡∏£‡πå</div>
            <div class="bg-indigo-600 text-white py-3 text-center text-sm font-bold uppercase">‡πÄ‡∏™‡∏≤‡∏£‡πå</div>
            </div>
        </div>
        <p class="mt-6 text-gray-400 text-xs text-center">* ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)</p>
      </div>

    </div>
  </div>

  <script>
    // 1. ‡πÉ‡∏™‡πà URL ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
    const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwBNjqWX1uj6cKX29C0N-UpfZLcZLoq4RfzYNXw1WE8meLz1wnLuzEf2teAd0qJBsFc/exec";
    
    let appointments = [];
    let currentMonth = new Date();

    // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà (‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏î‡∏µ‡∏ï)
    document.getElementById('date-input').min = new Date().toISOString().split('T')[0];

    // ‡∏™‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
    function showTab(tab) {
      const isBook = tab === 'book';
      document.getElementById('book-section').classList.toggle('hidden', !isBook);
      document.getElementById('list-section').classList.toggle('hidden', isBook);
      
      const btnBook = document.getElementById('btn-tab-book');
      const btnList = document.getElementById('btn-tab-list');
      
      if(isBook) {
        btnBook.className = "px-8 py-2.5 rounded-full font-medium transition-all bg-white text-indigo-700 shadow-lg";
        btnList.className = "px-8 py-2.5 rounded-full font-medium transition-all text-white hover:bg-white/10";
      } else {
        btnList.className = "px-8 py-2.5 rounded-full font-medium transition-all bg-white text-indigo-700 shadow-lg";
        btnBook.className = "px-8 py-2.5 rounded-full font-medium transition-all text-white hover:bg-white/10";
        fetchData(); // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î‡∏î‡∏π‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô
      }
    }

    // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Google Sheets
    async function handleSubmit(e) {
      e.preventDefault();
      const btn = document.getElementById('submit-btn');
      const spinner = document.getElementById('btn-spinner');
      const txt = document.getElementById('btn-text');
      
      const formData = new FormData(e.target);
      const services = Array.from(e.target.querySelectorAll('input[name="services"]:checked')).map(cb => cb.value);

      const payload = {
        coordinator_name: formData.get('coordinator_name'),
        department: formData.get('department'),
        phone_internal: formData.get('phone_internal'),
        event_title: formData.get('event_title'),
        services: services.join(', '),
        location: formData.get('location'),
        preferred_date: formData.get('preferred_date'),
        preferred_time: formData.get('preferred_time'),
        attachment_name: "Sent via Web App"
      };

      btn.disabled = true;
      spinner.classList.remove('hidden');
      txt.textContent = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...";

      try {
        await fetch(WEB_APP_URL, {
          method: 'POST',
          mode: 'no-cors',
          body: JSON.stringify(payload)
        });
        alert("‚úîÔ∏è ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏¥‡∏ß‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì");
        e.target.reset();
        showTab('list');
      } catch (err) {
        alert("‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï");
      } finally {
        btn.disabled = false;
        spinner.classList.add('hidden');
        txt.textContent = "‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠";
      }
    }

    // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô
    async function fetchData() {
      try {
        const res = await fetch(WEB_APP_URL);
        const data = await res.json();
        appointments = data;
        renderCalendar();
      } catch (err) {
        console.error("Fetch error:", err);
      }
    }

    // ‡∏ß‡∏≤‡∏î‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô
    function renderCalendar() {
      const grid = document.getElementById('calendar-grid');
      const monthLabel = document.getElementById('calendar-month');
      
      // ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏¥‡∏° (‡πÅ‡∏ï‡πà‡πÄ‡∏Å‡πá‡∏ö‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÑ‡∏ß‡πâ)
      const oldDays = grid.querySelectorAll('.day-cell');
      oldDays.forEach(d => d.remove());

      monthLabel.textContent = currentMonth.toLocaleDateString('th-TH', { month: 'long', year: 'numeric' });

      const firstDay = new Date(currentMonth.getFullYear(), currentMonth.getMonth(), 1).getDay();
      const daysInMonth = new Date(currentMonth.getFullYear(), currentMonth.getMonth() + 1, 0).getDate();
      const todayStr = new Date().toISOString().split('T')[0];

      // ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏ß‡∏±‡∏ô‡πÅ‡∏£‡∏Å‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
      for (let i = 0; i < firstDay; i++) {
        const empty = document.createElement('div');
        empty.className = "day-cell bg-gray-50 border-gray-100";
        grid.appendChild(empty);
      }

      // ‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ß‡∏±‡∏ô‡πÉ‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
      for (let d = 1; d <= daysInMonth; d++) {
        const dateObj = new Date(currentMonth.getFullYear(), currentMonth.getMonth(), d);
        const dateStr = dateObj.toISOString().split('T')[0];
        const isToday = dateStr === todayStr;
        
        const cell = document.createElement('div');
        cell.className = `day-cell p-2 border-gray-100 overflow-y-auto ${isToday ? 'today' : ''}`;
        cell.innerHTML = `<div class="text-xs font-bold ${isToday ? 'text-indigo-600' : 'text-gray-400'}">${d}</div>`;
        
        // ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πâ‡∏ô‡πÜ
        const dayEvents = appointments.filter(a => {
           // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏Å‡∏£‡∏ì‡∏µ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏≤‡∏Å Sheet ‡πÄ‡∏õ‡πá‡∏ô String ‡∏´‡∏£‡∏∑‡∏≠ Date Object
           const aptDate = a.preferred_date ? a.preferred_date.split('T')[0] : '';
           return aptDate === dateStr;
        });

        dayEvents.forEach(ev => {
          const badge = document.createElement('div');
          badge.className = "event-badge";
          badge.title = `‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠: ${ev.event_title}\n‡πÄ‡∏ß‡∏•‡∏≤: ${ev.preferred_time}\n‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô: ${ev.department}`;
          badge.textContent = `‚è∞ ${ev.preferred_time} ${ev.event_title}`;
          cell.appendChild(badge);
        });
        
        grid.appendChild(cell);
      }
    }

    function changeMonth(step) {
      currentMonth.setMonth(currentMonth.getMonth() + step);
      renderCalendar();
    }

    // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
    fetchData();
  </script>
</body>
</html>
