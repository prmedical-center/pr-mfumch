<!doctype html>
<html lang="th" class="h-full">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå - MFU Medical Center</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Kanit', sans-serif; }
    .gradient-bg { background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%); background-attachment: fixed; }
    
    /* Responsive Calendar */
    .day-cell { min-height: 80px; transition: 0.2s; background: #fff; border: 1px solid #f3f4f6; box-sizing: border-box; }
    @media (min-width: 768px) { .day-cell { min-height: 110px; } }
    .day-cell:hover { background-color: #f5f3ff; }
    .today { border: 2px solid #4f46e5 !important; background-color: #eef2ff; }
    .event-badge { font-size: 9px; padding: 2px 4px; border-radius: 4px; margin-top: 2px; background: #4f46e5; color: white; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
    .booked { background-color: #fee2e2; }

    /* PR Grid Info */
    .pr-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 12px; margin-bottom: 20px; }
    .pr-item { display: flex; gap: 12px; align-items: center; padding: 12px 16px; background: white; border-radius: 12px; border: 1px solid #e1e7ef; }
    .pr-item strong { display: block; font-size: 14px; color: #2e71b5; }
    .pr-note { padding: 10px 14px; background: #fff7e6; border-left: 4px solid #f0a500; border-radius: 6px; font-size: 13px; color: #8a5a00; }

    /* Inputs: prevent overflowing their grid cells */
    input[type="text"],
    input[type="tel"],
    input[type="date"],
    input[type="time"],
    textarea,
    select,
    .file-input {
      width: 100%;
      box-sizing: border-box; /* important to keep within container */
      max-width: 100%;
      min-width: 0; /* allows flex children to shrink */
    }

    /* Time inputs row: keep them tidy and prevent overflow */
    .time-row {
      display: flex;
      gap: 0.5rem;
      align-items: center;
    }
    .time-row .time-input {
      flex: 1 1 0;
      min-width: 0; /* critical to avoid overflowing when in flex container */
    }

    /* File input small styling */
    .file-input {
      font-size: 11px;
      color: #6b7280;
    }

    /* Make the date-picker and time-picker respect container rounding */
    input[type="date"]::-webkit-calendar-picker-indicator,
    input[type="time"]::-webkit-calendar-picker-indicator {
      cursor: pointer;
    }

    /* Small screens: stack time inputs */
    @media (max-width: 639px) {
      .time-row { flex-direction: column; gap: 0.5rem; }
    }
  </style>
</head>
<body class="h-full gradient-bg p-3 md:p-8 flex flex-col min-h-screen">
  <div class="max-w-6xl mx-auto w-full flex-grow">
    
    <div class="text-center text-white mb-8 fade-in">
      <h1 class="text-2xl md:text-4xl font-bold mb-2">‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå</h1>
      <p class="opacity-80 text-lg">‡∏á‡∏≤‡∏ô‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£ ‡∏ù‡πà‡∏≤‡∏¢‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•</p>
      <p class="text-white/90 text-base mt-1 font-light">‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡πÅ‡∏°‡πà‡∏ü‡πâ‡∏≤‡∏´‡∏•‡∏ß‡∏á</p>
    </div>

    <div class="max-w-5xl mx-auto mb-8 fade-in">
      <section class="pr-grid">
        <div class="pr-item"><span class="text-2xl">üé®</span><div><strong>‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÅ‡∏•‡∏∞‡∏ú‡∏•‡∏¥‡∏ï‡∏™‡∏∑‡πà‡∏≠</strong><div class="text-xs text-gray-500">10‚Äì20 ‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£</div></div></div>
        <div class="pr-item"><span class="text-2xl">üé¨</span><div><strong>‡∏ú‡∏•‡∏¥‡∏ï‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏î‡∏ï‡πà‡∏≠‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠</strong><div class="text-xs text-gray-500">10 ‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£</div></div></div>
        <div class="pr-item"><span class="text-2xl">üì∏</span><div><strong>‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</strong><div class="text-xs text-gray-500">‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ü‡∏•‡πå 30 ‡∏ß‡∏±‡∏ô</div></div></div>
        <div class="pr-item"><span class="text-2xl">üìù</span><div><strong>‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡πà‡∏≤‡∏ß ‡∏õ‡∏ä‡∏™.</strong><div class="text-xs text-gray-500">1‚Äì3 ‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£</div></div></div>
        <div class="pr-item"><span class="text-2xl">üé•</span><div><strong>‡∏Ç‡∏≠‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏ï‡∏π‡∏î‡∏¥‡πÇ‡∏≠</strong><div class="text-xs text-gray-500">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏¥‡∏ß‡∏†‡∏≤‡∏¢‡πÉ‡∏ô</div></div></div>
        <div class="pr-item"><span class="text-2xl">üé§</span><div><strong>‡∏û‡∏¥‡∏ò‡∏µ‡∏Å‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</strong><div class="text-xs text-gray-500">1‚Äì3 ‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£</div></div></div>
        <div class="pr-item"><span class="text-2xl">üì°</span><div><strong>‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ Live ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</strong><div class="text-xs text-gray-500">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏¥‡∏ß‡∏Å‡πà‡∏≠‡∏ô</div></div></div>
        <div class="pr-item"><span class="text-2xl">üéÅ</span><div><strong>‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏•‡∏∂‡∏Å</strong><div class="text-xs text-gray-500">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ï‡πá‡∏≠‡∏Å</div></div></div>
      </section>
      <div class="pr-note">‚ö†Ô∏è <strong>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 15 ‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏ö‡∏£‡∏∑‡πà‡∏ô</div>
    </div>

    <div class="flex justify-center mb-6">
      <div class="bg-black/20 p-1 rounded-full flex gap-1 border border-white/10">
        <button onclick="showTab('book')" id="btn-book" class="px-6 py-2 rounded-full text-sm font-medium bg-white text-indigo-600 shadow-lg transition-all">‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÉ‡∏´‡∏°‡πà</button>
        <button onclick="showTab('list')" id="btn-list" class="px-6 py-2 rounded-full text-sm font-medium text-white hover:bg-white/10 transition-all">‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏á‡∏≤‡∏ô</button>
      </div>
    </div>

    <div id="book-section" class="bg-white rounded-3xl md:rounded-[2rem] shadow-2xl p-6 md:p-10 fade-in">
      <form id="appointment-form" onsubmit="handleSubmit(event)" class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6">
        
        <div>
          <label class="text-sm font-semibold text-gray-600">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏á‡∏≤‡∏ô *</label>
          <input type="text" name="coordinator_name" required class="w-full px-4 py-3 rounded-xl border border-gray-200 outline-none focus:ring-2 focus:ring-indigo-400 text-sm">
        </div>

        <div>
          <label class="text-sm font-semibold text-gray-600">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô *</label>
          <input type="text" name="department" required class="w-full px-4 py-3 rounded-xl border border-gray-200 outline-none focus:ring-2 focus:ring-indigo-400 text-sm">
        </div>

        <div>
          <label class="text-sm font-semibold text-gray-600">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏†‡∏≤‡∏¢‡πÉ‡∏ô *</label>
          <input type="tel" name="phone_internal" required class="w-full px-4 py-3 rounded-xl border border-gray-200 outline-none focus:ring-2 focus:ring-indigo-400 text-sm">
        </div>

        <div>
          <label class="text-sm font-semibold text-gray-600">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏≤‡∏ô *</label>
          <input type="text" name="event_title" required class="w-full px-4 py-3 rounded-xl border border-gray-200 outline-none focus:ring-2 focus:ring-indigo-400 text-sm">
        </div>
        
        <div class="md:col-span-2">
          <label class="text-sm font-semibold text-gray-600 mb-2 block">‡∏Ç‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏ô‡∏∏‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 1 ‡∏Ç‡πâ‡∏≠)</label>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-3 bg-gray-50 p-5 rounded-xl border border-dashed border-gray-300">
            <label class="flex items-start gap-3 cursor-pointer p-2 hover:bg-white rounded-lg transition-colors">
              <input type="checkbox" name="services" value="‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û" class="mt-1 w-4 h-4 text-indigo-600">
              <span class="text-sm">‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û</span>
            </label>
            <label class="flex items-start gap-3 cursor-pointer p-2 hover:bg-white rounded-lg transition-colors">
              <input type="checkbox" name="services" value="‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏î‡∏ï‡πà‡∏≠‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠" class="mt-1 w-4 h-4 text-indigo-600">
              <span class="text-sm">‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏î‡∏ï‡πà‡∏≠‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠</span>
            </label>
            <label class="flex items-start gap-3 cursor-pointer p-2 hover:bg-white rounded-lg transition-colors">
              <input type="checkbox" name="services" value="‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏™‡∏∑‡πà‡∏≠" class="mt-1 w-4 h-4 text-indigo-600">
              <span class="text-sm">‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏™‡∏∑‡πà‡∏≠</span>
            </label>
            <label class="flex items-start gap-3 cursor-pointer p-2 hover:bg-white rounded-lg transition-colors">
              <input type="checkbox" name="services" value="‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà" class="mt-1 w-4 h-4 text-indigo-600">
              <span class="text-sm">‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà</span>
            </label>
            <label class="flex items-start gap-3 cursor-pointer p-2 hover:bg-white rounded-lg transition-colors">
              <input type="checkbox" name="services" value="‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏ò‡∏µ‡∏Å‡∏£" class="mt-1 w-4 h-4 text-indigo-600">
              <span class="text-sm">‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏ò‡∏µ‡∏Å‡∏£</span>
            </label>
            <label class="flex items-start gap-3 cursor-pointer p-2 hover:bg-white rounded-lg transition-colors">
              <input type="checkbox" name="services" value="‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ Live ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°" class="mt-1 w-4 h-4 text-indigo-600">
              <span class="text-sm">‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ Live ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</span>
            </label>
            <label class="flex items-start gap-3 cursor-pointer p-2 hover:bg-white rounded-lg transition-colors md:col-span-2 border-t border-gray-200 mt-1 pt-3">
              <input type="checkbox" id="other-checkbox" value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ" class="mt-1 w-4 h-4 text-indigo-600">
              <span class="text-sm font-semibold text-indigo-700">‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏∑‡πà‡∏ô ‡πÜ (‡∏£‡∏∞‡∏ö‡∏∏)</span>
            </label>
          </div>
          <input type="text" id="services-other" class="hidden mt-3 w-full px-4 py-3 rounded-xl border border-gray-200 outline-none focus:ring-2 focus:ring-indigo-400 text-sm bg-indigo-50/50" placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏∑‡πà‡∏ô ‡πÜ">
        </div>

        <div>
          <label class="text-sm font-semibold text-gray-600">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡∏á‡∏≤‡∏ô *</label>
          <input type="date" name="preferred_date" id="date-input" required class="w-full px-4 py-3 rounded-xl border border-gray-200 outline-none focus:ring-2 focus:ring-indigo-400 text-sm" aria-label="‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡∏á‡∏≤‡∏ô">
        </div>

        <div>
          <label class="text-sm font-semibold text-gray-600">‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤ *</label>
          <div class="time-row">
            <input type="time" name="start_time" required class="time-input px-4 py-3 rounded-xl border border-gray-200 outline-none focus:ring-2 focus:ring-indigo-400 text-sm">
            <input type="time" name="end_time" required class="time-input px-4 py-3 rounded-xl border border-gray-200 outline-none focus:ring-2 focus:ring-indigo-400 text-sm">
          </div>
        </div>
        
        <div class="md:col-span-2 space-y-2 bg-gray-50 p-4 rounded-xl border border-gray-200">
          <div class="flex flex-col md:flex-row md:items-center justify-between gap-2">
            <label class="text-sm font-semibold text-gray-700">‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÅ‡∏ô‡∏ö (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ) - ‡πÅ‡∏ô‡∏ö‡πÑ‡∏î‡πâ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 3 ‡πÑ‡∏ü‡∏•‡πå</label>
            <span class="text-[11px] text-gray-500 bg-white px-2 py-1 rounded border">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå: PDF, DOC, DOCX, JPG, PNG</span>
          </div>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-3 pt-2">
            <input type="file" id="file1" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png" class="file-input">
            <input type="file" id="file2" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png" class="file-input">
            <input type="file" id="file3" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png" class="file-input">
          </div>
        </div>

        <button type="submit" id="submit-btn" class="md:col-span-2 bg-indigo-600 text-white font-bold py-4 rounded-2xl hover:bg-indigo-700 shadow-xl transition-all flex justify-center items-center gap-2">
          <span id="btn-text">‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏à‡∏≠‡∏á‡∏Ñ‡∏¥‡∏ß</span>
        </button>
      </form>
    </div>

    <div id="list-section" class="hidden bg-white rounded-3xl md:rounded-[2rem] shadow-2xl p-4 md:p-8 overflow-hidden">
      <div class="flex justify-between items-center mb-6">
        <h2 id="calendar-month" class="text-xl font-bold text-gray-800 uppercase"></h2>
        <div class="flex gap-2">
          <button onclick="changeMonth(-1)" class="px-4 py-2 border rounded-lg hover:bg-gray-50 text-xs">‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button>
          <button onclick="changeMonth(1)" class="px-4 py-2 border rounded-lg hover:bg-gray-50 text-xs">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
        </div>
      </div>
      <div class="overflow-x-auto">
        <div id="calendar-grid" class="grid grid-cols-7 min-w-[600px] bg-gray-200 border border-gray-200 rounded-xl overflow-hidden"></div>
      </div>
    </div>

    <footer class="mt-12 mb-6 text-center text-white/80 text-sm">
      <div class="border-t border-white/20 pt-6 max-w-4xl mx-auto">
        <p class="font-semibold text-base mb-1">‡∏á‡∏≤‡∏ô‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</p>
        <p class="font-light">‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡πÅ‡∏°‡πà‡∏ü‡πâ‡∏≤‡∏´‡∏•‡∏ß‡∏á</p>
        <p class="opacity-75 mt-1 text-xs md:text-sm">365 ‡∏´‡∏°‡∏π‡πà 12 ‡∏ï.‡∏ô‡∏≤‡∏á‡πÅ‡∏• ‡∏≠.‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‡∏à.‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢ 57100</p>
        <div class="flex flex-col md:flex-row justify-center items-center gap-2 md:gap-6 mt-3 text-xs md:text-sm font-medium">
          <span class="flex items-center gap-1">üìû 053-914-199</span>
          <span class="hidden md:block">|</span>
          <span class="flex items-center gap-1">‚úâÔ∏è pr.medical-center@mfu.ac.th</span>
        </div>
      </div>
    </footer>

  </div>

  <script>
    // ‚ö†Ô∏è ‡πÉ‡∏™‡πà WEB_APP_URL ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
    const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwBNjqWX1uj6cKX29C0N-UpfZLcZLoq4RfzYNXw1WE8meLz1wnLuzEf2teAd0qJBsFc/exec";
    
    let appointments = [];
    let currentMonth = new Date();

    // Reference to date input
    const dateInput = document.getElementById('date-input');

    // Set minimum selectable date to today (prevents picking past dates)
    function setDateMin() {
      const todayISO = new Date().toISOString().split('T')[0];
      dateInput.min = todayISO;
    }
    setDateMin();

    // Prevent user from typing/pasting a date manually.
    // Still allow navigation keys (Tab, arrows, Enter, Esc) and allow using the browser date picker.
    dateInput.addEventListener('keydown', (e) => {
      const allowedKeys = ['Tab', 'ArrowLeft', 'ArrowRight', 'ArrowUp', 'ArrowDown', 'Escape', 'Enter', 'Home', 'End'];
      // allow function keys (F1..F12)
      if (allowedKeys.includes(e.key) || e.key.startsWith('F')) return;
      // If key represents a single printable character, block it.
      if (e.key.length === 1) {
        e.preventDefault();
      }
    });
    // Block paste (prevents pasting past dates)
    dateInput.addEventListener('paste', (e) => e.preventDefault());

    // Extra check when date changes (either via picker or programmatically)
    dateInput.addEventListener('change', (e) => {
      const chosen = e.target.value;
      const today = new Date(); today.setHours(0,0,0,0);
      const chosenDate = new Date(chosen + 'T00:00:00');
      if (chosen && chosenDate < today) {
        alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏ß‡∏±‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤');
        // fallback to min date
        e.target.value = dateInput.min;
      }
    });

    // Toggle ‡∏ä‡πà‡∏≠‡∏á‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏∑‡πà‡∏ô‡πÜ
    document.getElementById('other-checkbox').addEventListener('change', (e) => {
      document.getElementById('services-other').classList.toggle('hidden', !e.target.checked);
    });

    function showTab(tab) {
      document.getElementById('book-section').classList.toggle('hidden', tab !== 'book');
      document.getElementById('list-section').classList.toggle('hidden', tab === 'book');
      document.getElementById('btn-book').className = tab === 'book' ? "px-6 py-2 rounded-full text-sm font-medium bg-white text-indigo-600 shadow-lg" : "px-6 py-2 rounded-full text-sm font-medium text-white hover:bg-white/10 transition-all";
      document.getElementById('btn-list').className = tab !== 'book' ? "px-6 py-2 rounded-full text-sm font-medium bg-white text-indigo-600 shadow-lg" : "px-6 py-2 rounded-full text-sm font-medium text-white hover:bg-white/10 transition-all";
      if(tab === 'list') fetchData();
    }

    async function handleSubmit(e) {
      e.preventDefault();
      const fd = new FormData(e.target);
      const selDate = fd.get('preferred_date');

      // Extra server-side-safe validation: prevent past-dates on submit
      const today = new Date(); today.setHours(0,0,0,0);
      const chosenDate = new Date(selDate + 'T00:00:00');
      if (!selDate || chosenDate < today) {
        alert("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏ß‡∏±‡∏ô‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á");
        return;
      }

      if (appointments.some(a => a.preferred_date === selDate)) {
        alert("‚ùå ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß");
        return;
      }

      // ‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
      let svcs = Array.from(e.target.querySelectorAll('input[name="services"]:checked')).map(c => c.value);
      if(document.getElementById('other-checkbox').checked) {
        const otherTxt = document.getElementById('services-other').value.trim();
        if(otherTxt) svcs.push("‡∏≠‡∏∑‡πà‡∏ô‡πÜ: " + otherTxt);
        else svcs.push("‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏)");
      }
      
      if(svcs.length === 0) { alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏Ç‡πâ‡∏≠"); return; }

      let files = []; 
      for(let i=1; i<=3; i++) { 
        if(document.getElementById(`file${i}`).files[0]) files.push(document.getElementById(`file${i}`).files[0].name); 
      }

      const payload = {
        coordinator_name: fd.get('coordinator_name'),
        department: fd.get('department'),
        phone_internal: fd.get('phone_internal'),
        event_title: fd.get('event_title'),
        services: svcs.join(', '),
        location: "‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå",
        preferred_date: selDate,
        time_range: `${fd.get('start_time')} - ${fd.get('end_time')}`,
        attachment_name: files.join(', ') || "‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå"
      };

      const btn = document.getElementById('submit-btn');
      btn.disabled = true; btn.querySelector('#btn-text').innerText = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á...";
      try {
        await fetch(WEB_APP_URL, { method: 'POST', body: JSON.stringify(payload) });
        alert("‚úîÔ∏è ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!"); e.target.reset(); document.getElementById('services-other').classList.add('hidden');
        setDateMin(); // re-apply min in case of timezone changes
        fetchData(); showTab('list');
      } catch (err) { console.warn(err); alert("‚ö†Ô∏è ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏Ç‡∏ì‡∏∞‡∏™‡πà‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á"); }
      finally { btn.disabled = false; btn.querySelector('#btn-text').innerText = "‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏à‡∏≠‡∏á‡∏Ñ‡∏¥‡∏ß"; }
    }

    async function fetchData() {
      try {
        const res = await fetch(WEB_APP_URL);
        // Expecting array of appointments [{ preferred_date: 'YYYY-MM-DD', preferred_time: '08:00', event_title: '...' }, ...]
        appointments = await res.json();
        renderCalendar();
      } catch (err) { console.error("Fetch error", err); }
    }

    function renderCalendar() {
      const grid = document.getElementById('calendar-grid');
      const monthLabel = document.getElementById('calendar-month');
      grid.innerHTML = '<div class="bg-indigo-600 text-white py-2 text-center text-xs font-bold uppercase">‡∏≠‡∏≤</div><div class="bg-indigo-600 text-white py-2 text-center text-xs font-bold uppercase">‡∏à</div><div class="bg-indigo-600 text-white py-2 text-center text-xs font-bold uppercase">‡∏≠</div><div class="bg-indigo-600 text-white py-2 text-center text-xs font-bold uppercase">‡∏û</div><div class="bg-indigo-600 text-white py-2 text-center text-xs font-bold uppercase">‡∏û‡∏§</div><div class="bg-indigo-600 text-white py-2 text-center text-xs font-bold uppercase">‡∏®</div><div class="bg-indigo-600 text-white py-2 text-center text-xs font-bold uppercase">‡∏™</div>';
      
      monthLabel.textContent = currentMonth.toLocaleDateString('th-TH', { month: 'long', year: 'numeric' });
      const firstDay = new Date(currentMonth.getFullYear(), currentMonth.getMonth(), 1).getDay();
      const daysInMonth = new Date(currentMonth.getFullYear(), currentMonth.getMonth() + 1, 0).getDate();
      const todayStr = new Date().toLocaleDateString('en-CA');

      for (let i = 0; i < firstDay; i++) {
        const empty = document.createElement('div'); empty.className = "day-cell bg-gray-50";
        grid.appendChild(empty);
      }

      for (let d = 1; d <= daysInMonth; d++) {
        const dateStr = `${currentMonth.getFullYear()}-${String(currentMonth.getMonth()+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
        const event = appointments.find(a => a.preferred_date === dateStr);
        const cell = document.createElement('div');
        cell.className = `day-cell p-1 md:p-2 ${event ? 'booked' : ''} ${dateStr === todayStr ? 'today' : ''}`;
        cell.innerHTML = `<div class="text-[10px] font-bold ${dateStr === todayStr ? 'text-indigo-600' : 'text-gray-400'}">${d}</div>`;
        if (event) {
          const b = document.createElement('div'); b.className = "event-badge"; b.innerText = `‚è∞ ${event.preferred_time || ''}`; cell.appendChild(b);
          const t = document.createElement('div'); t.className = "text-[8px] truncate text-indigo-700 mt-1"; t.innerText = event.event_title || '';
          cell.appendChild(t);
        }
        grid.appendChild(cell);
      }
    }
    function changeMonth(s) { currentMonth.setMonth(currentMonth.getMonth() + s); renderCalendar(); }
    fetchData();
  </script>
</body>
</html>
